# Введение к Практике 4. Ансамбли: бэггинг, блендинг и стекинг

## Цель практики

Практика посвящена **ансамблевым методам** в задаче регрессии: вы научитесь объединять базовые модели с помощью **бэггинга**, **блендинга** и **стекинга**, оценивать качество, сравнивать конфигурации и выбирать наиболее удачную.

## Данные

Датасет **Used Cars Prices in UK** (Kaggle): подержанные автомобили в Великобритании. Признаки: пробег, год выпуска, тип двигателя и др. **Целевая переменная** — цена автомобиля.

[Описание датасета на Kaggle](https://www.kaggle.com/datasets/muhammadawaistayyab/used-cars-prices-in-uk)

## Что входит в работу

- **Загрузка и предобработка данных:**
  - Удаление столбцов (`Unnamed: 0`, `Service history`, `title`).
  - Заполнение пропусков (в т.ч. в `Previous Owners` и в вещественных полях).
  - Обработка категориальных переменных: объединение редких классов в «Other», кодирование (например, `pd.get_dummies` или `OneHotEncoder`); отдельное внимание полю `Engine`.
  - Разбиение на train/test 80/20, `random_state=42`, обновление индексов.
- **Бэггинг решающих деревьев:** построение и оптимизация (в т.ч. подбор гиперпараметров).
- **Блендинг:** реализация и оценка.
- **Стекинг:** несколько вариантов, подбор гиперпараметров.
- **Сравнение моделей** и выбор оптимальной конфигурации.

Подбор гиперпараметров через `GridSearchCV` может занимать **около 10–15 минут** — это нормально.

## Необходимые инструменты

- **Python:** pandas, numpy, при необходимости визуализация.
- **sklearn:** решающие деревья, бэггинг, стекинг, разбиение выборок, метрики, предобработка (в т.ч. кодирование категориальных признаков).

## Рекомендации

- Выполняйте пункты по порядку.
- Код и выводы оформляйте в указанных местах; при необходимости добавляйте ячейки, не удаляя формулировки заданий.
- Учитывайте время расчёта GridSearch при планировании экспериментов.

## Связь с ноутбуком

Рабочий ноутбук: **`Практика_4.ipynb`**. Данные загружаются через `gdown` по ссылке из ноутбука.
